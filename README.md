# Рефакторинг order_processing.py

## Проблемы качества

1. **Низкая поддерживаемость**: Изменение логики скидок требовало изменения основной функции
2. **Слабая читаемость**: Логика была перемешана, сложно понять последовательность операций
3. **Случайные значения**: В коде были разбросаны значения без пояснений
4. **Длинная функция**: Функция `process_checkout` содержала слишком много ответственностей (парсинг, валидация, расчёты)

## Применённый рефакторинг

1. **Выделение функций**: Логика разбита на отдельные функции:
   - `parse_request()` - разбор входных данных
   - `validate_request()` - валидация всех входных параметров
   - `calculate_subtotal()` - расчёт промежуточной суммы
   - `calculate_discount()` - расчёт скидки по купону
   - `calculate_tax()` - расчёт налога

2. **Вынос констант**: Все случайные значения вынесены в константы:
   - `TAX_RATE = 0.21`
   - `DEFAULT_CURRENCY = "USD"`
   - Пороговые значения для скидок
   - Константы для купонов и скидок

3. **Улучшение читаемости**: 
   - Функция `process_checkout` теперь читается как сценарий
   - Имена функций отражают их назначение

4. **Улучшение поддерживаемости**:
   - Добавление новых купонов требует изменения только `calculate_discount()`
   - Изменение налоговой ставки требует изменения только константы
   - Валидация вынесена в отдельную функцию

## Результаты рефакторинга

### Что стало проще читать:
- Основная функция `process_checkout` сократилась
- Логика стала линейной и предсказуемой
- Каждый шаг обработки заказа чётко отделён

### Что стало проще менять:
1. **Добавление нового купона** - нужно только добавить условие в `calculate_discount()`
2. **Изменение налоговой ставки** - меняется одна константа `TAX_RATE`
3. **Изменение логики валидации** - правки только в `validate_request()`
4. **Изменение порогов скидок** - правки только в константах
